webpackJsonp([12],{"7Dxt":function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=Object(f.a)(e),n=function(e){function n(){var t,i,a;r(this,n);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return t=i=o(this,e.call.apply(e,[this].concat(c))),i.state={impressionStarted:!1,impressionLogged:!1},i.currentNs=function(){return Date.now()*w},i.startTime=0,i.debugPinImpressions=v&&"Pin"===i.props.impressionType&&i.props.viewer.isEmployee,i.handleVisibilityChanged=function(e){var t=i.props,n=t.componentType,r=t.contextLog,o=t.contextLogData,a=t.impressionAuxFields,s=t.impressionType,c=t.loggingId,l=t.slotIndex,p=t.viewParameter,u=t.viewType,d=t.viewData;if(e)i.startTime=i.currentNs(),i.debugPinImpressions&&(console.log(l+" started timer"),i.setState({impressionStarted:!0}));else{var f,h,m=b[s],y=m.idType,v=i.currentNs(),w=Object.assign((f={endTime:v},f[y]=c,f.slotIndex=l,f.time=i.startTime,f.renderDuration=v-i.startTime,f),a);r(m.eventType,Object.assign({component:n,eventData:(h={},h[m.impressionType]=[w],h),view:u,viewParameter:p,viewData:d},o)),i.debugPinImpressions&&(console.log(l+" logged for "+(v-i.startTime)/1e9+"s"),i.setState({impressionStarted:!1,impressionLogged:!0}))}},a=t,o(i,a)}return i(n,e),n.prototype.render=function e(){return s.createElement(t,Object.assign({onVisibilityChanged:this.handleVisibilityChanged,debugImpressionStarted:this.debugPinImpressions?this.state.impressionStarted:void 0,debugImpressionLogged:this.debugPinImpressions?this.state.impressionLogged:void 0},this.props))},n}(s.Component);return Object(h.compose)(y.a,d.a)(n)}t.a=a;var s=n("d6ZO"),c=n.n(s),l=n("IaRT"),p=n.n(l),u=n("FJZF"),d=n("i0Ug"),f=n("sHx0"),h=n("MQ2h"),m=n.n(h),y=n("Kqaz"),v=u.a.getQueryStringParams()&&u.a.getQueryStringParams().debug_impression_log,b={Article:{impressionType:"articleImpressions",idType:"articleIdStr",eventType:3829},Pin:{impressionType:"pinImpressions",idType:"pinIdStr",eventType:18},Board:{impressionType:"boardImpressions",idType:"boardIdStr",eventType:3700},Interest:{impressionType:"topicImpressions",idType:"topicIdStr",eventType:3703},Search:{impressionType:"searchImpressions",idType:"term",eventType:3803},User:{impressionType:"userImpressions",idType:"userIdStr",eventType:3704},News:{impressionType:"newsHubData",idType:"newsIdStr",eventType:4110},Story:{impressionType:"storyImpressions",idType:"storyIdStr",eventType:170}},w=1e6},RvAN:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n("d6ZO"),s=n.n(a),c=n("GGB8"),l=n.n(c),p=n("W/Cr"),u=n("WBZ1"),d=n.n(u),f=n("gEaE"),h=n("JyNp"),m=n("7IpV"),y={UP:"up",DOWN:"down"},v=100,b=function(e){function t(){var n,i,a;r(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return n=i=o(this,e.call.apply(e,[this].concat(c))),i.handleScroll=d()(function(){if(!i.props.listResource.isFetching){var e=i.props.scrollThreshold;Object(m.c)(i._container)-Object(m.d)(i._container)-Object(m.a)(i._container)<e&&i.fetchMore()}},v),i.addEventListeners=function(e){var t=i.props.useWindow;t&&(e=window),i.removeEventListeners(),e&&(t||e.addEventListener("wheel",i.preventScroll),e.addEventListener("scroll",i.handleScroll)),i._container=e},i.preventScroll=function(e){var t=e.deltaY<0?y.UP:y.DOWN,n=i._container.scrollHeight-i._container.scrollTop-i._container.clientHeight==0,r=0===i._container.scrollTop;(t===y.DOWN&&n||t===y.UP&&r)&&e.preventDefault()},a=n,o(i,a)}return i(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function e(t){var n=t.onDataFetched,r=t.listResource.data;r&&n(r.length)},t.prototype.componentWillUnmount=function e(){this.removeEventListeners()},t.prototype.removeEventListeners=function e(){var t=this.props.useWindow;this._container&&(t||this._container.removeEventListener("wheel",this.preventScroll),this._container.removeEventListener("scroll",this.handleScroll))},t.prototype.fetchMore=function e(){this.props.listResource.isFetching||(this.props.listResource.isAtEnd?this._container.removeEventListener("scroll",this.handleScroll):this.props.listResource.fetchMore())},t.prototype.render=function e(){var t=this.props,n=t.className,r=t.renderEmptyState,o=t.renderItem,i=this.props.listResource.data;return!this.props.listResource.isFetching&&i&&0===i.length?r():s.a.createElement("div",{className:l()(n,"listContainer"),ref:this.addEventListeners},i?s.a.createElement("ul",{className:"scrollableList"},i.map(function(e,t){return o(e,t)})):null,this.props.listResource.isAtEnd?null:s.a.createElement("div",{className:"loadingItem"},s.a.createElement(f.G,{accessibilityLabel:p.a._("Loading items"),show:this.props.listResource.isFetching})))},t}(a.Component);b.defaultProps={onDataFetched:function e(){},scrollThreshold:400,useWindow:!1},t.a=b},sHx0:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=n("d6ZO"),s=n.n(a),c=n("RklN"),l=n.n(c),p=n("Cjb7"),u=new Map,d=null,f=function e(t){t.forEach(function(e){var t=u.get(e.target);t&&t(e)})},h=function e(t){d.unobserve(t),u.delete(t)},m=function e(t,n){var r={root:document.querySelector("#mainContainer"),rootMargin:"-64px 0px 0px 0px",threshold:[0,1]};d=d||new window.IntersectionObserver(f,r),u.set(t,n),d.observe(t)},y=function e(t){return u.has(t)},v=function e(t){var n=function(e){function n(){var t,i,a;r(this,n);for(var s=arguments.length,c=Array(s),d=0;d<s;d++)c[d]=arguments[d];return t=i=o(this,e.call.apply(e,[this].concat(c))),i.seen=!1,i.flushTimeout=null,i.attachDenzelNavigateListener=function(){i.denzelNavigateListener=p.a.instance.subscribe("site","navigateStarted",function(e,t,n,r){var o=new RegExp("/pin/[\\w|-]+/$");!r&&n&&"string"==typeof n.url&&o.test(n.url)&&i.leave()})},i.detachDenzelNavigateListener=function(){i.denzelNavigateListener&&(i.denzelNavigateListener.unsubscribe(),delete i.denzelNavigateListener)},i.enter=function(e){var t=e.intersectionRatio>0;i.seen=t,i.seen&&(i.props.onVisibilityChanged(!0),i.attachDenzelNavigateListener())},i.leave=function(){var e=i._node;e&&y(e)&&i.seen&&(i.props.onVisibilityChanged(!1),i.seen=!1,i.detachDenzelNavigateListener())},i.observe=function(){try{i._node=l.a.findDOMNode(i)}catch(e){return}if(i._node){var e=i._node;m(e,function(t){if(u.has(e)){var n=i.props.trackFullVisible?t.intersectionRatio>=1:t.intersectionRatio>0,r=i.props.trackFullVisible?0===t.intersectionRatio:!n;!i.seen&&n?i.enter(t):i.seen&&r&&i.leave()}})}},a=t,o(i,a)}return i(n,e),n.prototype.componentDidMount=function e(){this.observe()},n.prototype.componentWillUnmount=function e(){var t=this._node;t&&(this.leave(),h(t))},n.prototype.render=function e(){return s.a.createElement(t,this.props)},n}(a.Component);return n.displayName="WithVisibilityChanged("+(t.displayName||t.name)+")",n};t.a=v},wygQ:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var d=n("d6ZO"),f=n.n(d),h=n("OIxG"),m=n("SnoN"),y=n("GGB8"),v=n.n(y),b=n("IaRT"),w=n.n(b),g={ONE:1,TWO:2,END:3},E=function(e){function t(){var n,i,a;r(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return n=i=o(this,e.call.apply(e,[this].concat(c))),i.state={educationStep:g.ONE},i.toStepTwo=function(){i.setState({educationStep:g.TWO})},i.dismissEducation=function(){var e=i.props.handleDismiss;i.setState({educationStep:g.END}),e()},a=n,o(i,a)}return i(t,e),t.prototype.componentDidMount=function e(){var t=this,n=this.props.stepDelay;this.educationStepTimer=setTimeout(function(){t.state.educationStep<g.TWO&&t.setState({educationStep:g.TWO})},n)},t.prototype.componentWillUnmount=function e(){clearTimeout(this.educationStepTimer)},t.prototype.renderPill=function e(t,n,r){return f.a.createElement("button",{onClick:r,className:v()("educationPill","slideIn",{fadeOut:n})},f.a.createElement("div",{className:"message"},t))},t.prototype.render=function e(){var t=this.state.educationStep,n=this.props,r=n.titleText,o=n.titleText2,i=this.renderPill(r,t===g.TWO,this.toStepTwo),a=this.renderPill(o,t===g.END,this.dismissEducation);return f.a.createElement("div",{className:"newsHubEducation"},f.a.createElement("div",{className:"educationStep stepOne"},(t===g.ONE||t===g.TWO)&&i),f.a.createElement("div",{className:"educationStep stepTwo bottom"},(t===g.TWO||t===g.END)&&a))},t}(d.Component),T=n("W/Cr"),_=n("zFaW"),O=n("7Dxt"),x=Object(O.a)(_.a),S=n("ZtCB"),I=n.n(S),N=n("gEaE"),C=function(e){function t(){var n,r,o;a(this,t);for(var i=arguments.length,c=Array(i),l=0;l<i;l++)c[l]=arguments[l];return n=r=s(this,e.call.apply(e,[this].concat(c))),r.handleButtonClick=function(){I.a.create("NewsHubResource").callDelete({showError:!1}).then(function(e){return r.props.handleClick()})},o=n,s(r,o)}return c(t,e),t.prototype.render=function e(){return f.a.createElement("div",{className:"newsHubMarkReadButton"},f.a.createElement(N.c,{size:"md",text:T.a._("Mark all as read","mark all the unread notifications as read"),inline:!0,onClick:this.handleButtonClick}))},t}(d.Component),D=n("RvAN"),j=n("nX0T"),P=n("mHth"),R=n("YZkw"),k=n("MQ2h"),L=n.n(k),W=n("+B8E"),H=n("Kqaz"),M=n("JyNp"),F=4,z=function(e){function t(n){l(this,t);var r=p(this,e.call(this,n));r.state={shouldEducate:!1},r.onDataFetched=function(e){var t=r.props.experience;r.hasEarlier=!1,t&&e>F&&!r.state.shouldEducate&&r.setState({shouldEducate:!0})},r.handleItemClick=function(){r.handleComplete(),r.props.handleItemClick()},r.handleComplete=function(){var e=r.props,t=e.experienceClient,n=e.experience;n&&t.completeExperience(n.placement_id,n.experience_id)},r.handleDismiss=function(){var e=r.props,t=e.experienceClient,n=e.experience;n&&t.dismissExperience(n.placement_id,n.experience_id)},r.handleMarkAllButtonClicked=function(){r.props.newsHubResource.refreshData()},r.renderItem=function(e,t){var n={impressionAuxFields:{newsType:e.news_type},impressionType:"News",loggingId:e.id,slotIndex:t,viewParameter:3081,viewType:107};return f.a.createElement("li",{className:"newsHubItemWrapper",key:t},r.renderDate(e.last_updated_at,t),f.a.createElement(x,Object.assign({contentItemCount:e.content_item_count,contentItems:e.content_items,contentText:e.content_text,displayMode:e.encoded_display_mode,handleClick:r.handleItemClick,headerIconImageUrl:e.header_icon_image_url,headerIconObjects:e.header_icon_objects,headerText:e.header_text,id:e.id,lastUpdatedAt:e.last_updated_at,overrideClickUrl:e.override_click_url,subHeaderText:e.sub_header_text,siteType:r.props.siteType,textMapping:e.text_mapping,type:e.news_type,unread:e.unread},n)))},r.renderEmptyState=function(){return f.a.createElement(N.b,{height:400},f.a.createElement(N.b,{display:"flex",justifyContent:"center",color:"darkGray",shape:"pill",paddingY:5,margin:5},f.a.createElement(N.h,{xs:10},f.a.createElement(N.K,{bold:!0,color:"white",size:"lg"},T.a._("New! Discover ideas from your friends, followers and people who love your Pins!")))))},r.hasEarlier=!1;var o=r.props.requestContext;return r.unreadExpGroup=new W.c(o,"news_hub_unread"),r}return u(t,e),t.prototype.getChildContext=function e(){return{preloadingSupported:!0}},t.prototype.componentDidMount=function e(){var t=this.props,n=t.experience,r=t.experienceClient;n&&r.viewExperience(n.placement_id,n.experience_id),this.logPanelImpression()},t.prototype.getEducation=function e(){var t=this.props.experience;if(this.state.shouldEducate&&t){var n=t.display_data,r=n.step_delay,o=n.title_text,i=n.title_text_2;return f.a.createElement(E,{handleDismiss:this.handleDismiss,stepDelay:r,titleText:o,titleText2:i})}return null},t.prototype.logPanelImpression=function e(){var t=this.props.contextLog,n=m.a.getInstance(),r=n.getViewFromContext();t(13,{view:107,viewParameter:3081}),n.addViewToContext(r)},t.prototype.renderDate=function e(t,n){var r=new Date(t);r.setHours(0,0,0,0);var o=void 0;if(0===n)this.firstDay=r,o=T.a._("New","subtitle for new notifications in notification dropdown");else{if(r.getTime()===this.firstDay.getTime()||this.hasEarlier)return null;o=T.a._("Earlier","subtitle for old notifications in notification dropdown"),this.hasEarlier=!0}return f.a.createElement("div",{className:"newsHubItemDate"},f.a.createElement(N.K,{bold:!0,size:"md",color:"gray"},o))},t.prototype.renderTitle=function e(){return f.a.createElement("div",{className:"newsHubTitle"},f.a.createElement(N.K,{bold:!0,inline:!0,size:"xl"},T.a._("Notifications","Title for news hub dropdown on the right upper corner in home page")))},t.prototype.renderMarkReadButton=function e(){return this.unreadExpGroup.enabled()?f.a.createElement(C,{handleClick:this.handleMarkAllButtonClicked}):null},t.prototype.render=function e(){return f.a.createElement(j.a,{view:107,viewParameter:3081},f.a.createElement("div",null,this.getEducation(),this.renderTitle(),f.a.createElement(D.a,{className:"newsHubPanel",onDataFetched:this.onDataFetched,renderEmptyState:this.renderEmptyState,renderItem:this.renderItem,listResource:this.props.newsHubResource})))},t}(d.Component);z.childContextTypes={preloadingSupported:w.a.bool.isRequired},z.defaultProps={handleItemClick:function e(){}};var A=t.a=Object(k.compose)(h.b,Object(R.a)(1000035),H.a,P.a,Object(M.b)({name:"NewsHubResource",key:"newsHubResource",options:function e(t){return{page_size:10}}},{allowStale:!1}))(z)},ybIz:function(e,t,n){"use strict";function r(e){var t=e.handleItemClick,n=e.locale,r=e.siteType;return i.a.createElement("div",{className:"NewsConversationsDropdown"},i.a.createElement("div",{className:"content"},i.a.createElement(a.a,{handleItemClick:t,locale:n,siteType:r})))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var o=n("d6ZO"),i=n.n(o),a=n("wygQ"),s=n("IaRT"),c=n.n(s)}});